# Accounts Receivable & Sales Performance Analytics

## ðŸ“Š Project Overview
This project provides a full-stack solution for monitoring corporate financial health, specifically focusing on the relationship between Sales Performance and Cash Collection Efficiency. By integrating SQL Server, Python, and Power BI, the project transforms raw transaction data into actionable insights regarding liquidity and credit risk.

## ðŸ› ï¸ Tech Stack

* **Database**: SQL Server (T-SQL) for data warehousing and view orchestration.
* **ETL & Data Science**: Python (Pandas, NumPy, SQLAlchemy) for realistic payment delay simulation and data transformation.
* **Visualization**: Power BI (DAX) for interactive dashboarding and KPI tracking.

## ðŸ—ï¸ Data Pipeline & Architecture

### 1. SQL Server Layer (The Foundation)
* **Data Source:** Sourced from a refined **Star Schema** within the `AdventureWorks` database.
* **Production View:** Created `v_FinancialAnalysis` using **LEFT JOINs** to ensure 100% financial integrity, ensuring no sales records are lost even if dimension attributes are missing.
* **Data Cleaning:** Implemented `ISNULL` logic and string concatenation to prepare "clean" fields for the reporting layer.

### 2. Python Layer (The Simulation & ETL)
* **Data Simulation:** Developed a Python script to simulate realistic business behavior, addressing the lack of granular payment dates in standard databases.
* **Statistical Simulation:** Used a **Gamma Distribution** to generate realistic payment delays, creating a "long-tail" effect typical in B2B finance.
* **Feature Engineering:** Automated the calculation of **Aging Buckets** (On Time, 1-30 Days, etc.) and **DaysToPay**.
* **Error Handling:** The script includes a robust `try-except` structure and logging to handle SQL connection issues or file permission errors.

### 3. Power BI Layer (The Insights)
* **Analytics Dashboard:** Created a multi-dimensional dashboard to provide a comprehensive view of company performance and financial health.
* **DSO (Days Sales Outstanding):** Implemented a **3-Month Rolling Average** line to smooth out monthly volatility and reveal the true collection trend.
* **CEI (Collection Effectiveness Index):** A critical KPI measuring the quality of the collection process:
$$\text{CEI \%} = \left( \frac{\text{Current Collections}}{\text{Total Billable Amount}} \right) \times 100$$
* **Dynamic UX:** Features synchronized slicers and **Conditional Formatting** on the Gauge chart to immediately signal if YTD sales are lagging behind the previous year.


## ðŸ“ˆ Key Insights Captured
* Aging Breakdown: Identifies that while 80% of debt is "1-30 Days Late," the CEI remains high, suggesting a stable but slightly delayed cash inflow.
* Regional Trends: Users can filter by Country (e.g., United States, Australia) to see how collection efficiency varies by market.
* Target Achievement: The Gauge visual provides an "at-a-glance" status of current YTD sales vs. targets, using semantic colors (Red/Green) for instant interpretation.

## ðŸš€ How to Run
1. SQL: Execute the deployment script in SSMS to create the v_FinancialAnalysis view.
2. Python: Run the financial_analysis.ipynb (or .py) script. Ensure ipykernel and pyodbc are installed in your environment.
3. Power BI: Open the .pbix file and click Refresh to pull the latest data from the generated finance_data_ready.csv.

## ðŸ—ºï¸ Project Logic & Data Flow
```mermaid
graph LR
    A[(SQL Server)] ---->|View:<br/>v_FinancialAnalysis| B[Python ETL]
    B ---->|Gamma Distribution<br/>Simulation| C(finance_data_ready.csv)
    C ---->|Data Import| D{AR Dashboard}

    style A fill:#f9f,stroke:#333,stroke-width:2px,color:#000
    style B fill:#bbf,stroke:#333,stroke-width:2px,color:#000
    style C fill:#dfd,stroke:#333,stroke-width:2px,color:#000
    style D fill:#f96,stroke:#333,stroke-width:2px,color:#000
```

## ðŸ“‚ Repository Structure
```
Accounts-Receivable-Sales-Performance-Analytics/
â”œâ”€â”€ data/                       # Storage for processed datasets
â”‚   â””â”€â”€ finance_data_ready.csv  # Final dataset generated by Python
â”œâ”€â”€ sql/                        # SQL transformation scripts
â”‚   â””â”€â”€ v_FinancialAnalysis.sql # View definition with LEFT JOIN logic
â”œâ”€â”€ python/                     # ETL and Simulation logic
â”‚   â””â”€â”€ financial_analysis.ipynb # Jupyter Notebook with Gamma simulation
â”œâ”€â”€ power-bi/                   # Visualization layer
â”‚   â””â”€â”€ AR_Dashboard.pbix       # Final Power BI report file
â”œâ”€â”€ docs/                       # Project documentation and assets
â”‚   â””â”€â”€ architecture_flow.drawio # Optional: flow diagrams
â”œâ”€â”€ README.md                   # Main project overview and instructions
â”œâ”€â”€ requirements.txt            # Python dependencies (pandas, sqlalchemy, etc.)
```
